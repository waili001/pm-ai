<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PM AI API Documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.15.5/swagger-ui.css" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }

        *,
        *:before,
        *:after {
            box-sizing: inherit;
        }

        body {
            margin: 0;
            background: #fafafa;
        }
    </style>
</head>

<body>
    <div id="swagger-ui"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.15.5/swagger-ui-bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/swagger-ui/4.15.5/swagger-ui-standalone-preset.js"></script>
    <script>
        window.onload = function () {
            const spec = {
                "openapi": "3.0.0",
                "info": {
                    "title": "PM AI API",
                    "version": "1.0.0"
                },
                "paths": {
                    "/api/members/departments": {
                        "get": {
                            "summary": "Get all departments",
                            "responses": {
                                "200": { "description": "List of departments" }
                            }
                        }
                    },
                    "/api/members/status": {
                        "get": {
                            "summary": "Get Member Status",
                            "parameters": [
                                {
                                    "name": "department",
                                    "in": "query",
                                    "required": false,
                                    "schema": { "type": "string" }
                                }
                            ],
                            "responses": {
                                "200": { "description": "Member status list" }
                            }
                        }
                    },
                    "/api/project/active": {
                        "get": {
                            "summary": "Get Active TP Projects",
                            "description": "Fetch all active TP projects (Status != Closed/Resolved).",
                            "responses": {
                                "200": { "description": "List of active projects" }
                            }
                        }
                    },
                    "/api/project/programs": {
                        "get": {
                            "summary": "Get Programs",
                            "description": "Fetch all unique program titles from TP_PROGRAM.",
                            "responses": {
                                "200": { "description": "List of program titles" }
                            }
                        }
                    },
                    "/api/project/planning": {
                        "get": {
                            "summary": "Get Project Planning Data",
                            "description": "Fetch projects for Planning Dashboard with optional filtering. Projects with 'Blocked' status are excluded.",
                            "parameters": [
                                {
                                    "name": "program",
                                    "in": "query",
                                    "required": false,
                                    "schema": { "type": "string" }
                                },
                                {
                                    "name": "department",
                                    "in": "query",
                                    "required": false,
                                    "schema": { "type": "string" }
                                },
                                {
                                    "name": "project_type",
                                    "in": "query",
                                    "required": false,
                                    "schema": { "type": "string" }
                                }
                            ],
                            "responses": {
                                "200": { "description": "List of projects for planning" }
                            }
                        }
                    },
                    "/api/project/departments": {
                        "get": {
                            "summary": "Get Project Departments",
                            "description": "Fetch all unique departments from TCG_DEPT.",
                            "responses": {
                                "200": { "description": "List of department names" }
                            }
                        }
                    },
                    "/api/project/{tp_number}/tcg_tickets": {
                        "get": {
                            "summary": "Get TCG Tickets by TP",
                            "parameters": [
                                {
                                    "name": "tp_number",
                                    "in": "path",
                                    "required": true,
                                    "schema": { "type": "string" }
                                }
                            ],
                            "responses": {
                                "200": { "description": "List of TCG tickets for the project" }
                            }
                        }
                    },
                    "/api/project/ticket/{ticket_number}": {
                        "get": {
                            "summary": "Get Ticket Details",
                            "description": "Fetch details for a specific ticket (TCG or TP).",
                            "parameters": [
                                {
                                    "name": "ticket_number",
                                    "in": "path",
                                    "required": true,
                                    "schema": { "type": "string" }
                                }
                            ],
                            "responses": {
                                "200": {
                                    "description": "Ticket details",
                                    "content": {
                                        "application/json": {
                                            "schema": {
                                                "type": "object",
                                                "properties": {
                                                    "ticket_number": { "type": "string" },
                                                    "title": { "type": "string" },
                                                    "status": { "type": "string" },
                                                    "assignee": { "type": "string" },
                                                    "reporter": { "type": "string" },
                                                    "released_date": { "type": "string" },
                                                    "due_day": { "type": "string" },
                                                    "start_date": { "type": "string" },
                                                    "sit_date": { "type": "string" },
                                                    "issue_type": { "type": "string", "example": "TP" },
                                                    "icr_count": { "type": "integer" },
                                                    "completed_percentage": { "type": "integer", "example": 85 },
                                                    "sort_order": { "type": "integer", "example": 1 }
                                                }
                                            }
                                        }
                                    }
                                },
                                "404": { "description": "Ticket not found" }
                            }
                        }
                    },
                    "/api/project/reorder": {
                        "post": {
                            "tags": ["project"],
                            "summary": "Reorder projects",
                            "description": "Update sort_order for a list of projects within a status.",
                            "requestBody": {
                                "required": true,
                                "content": {
                                    "application/json": {
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "status": { "type": "string" },
                                                "project_ids": {
                                                    "type": "array",
                                                    "items": { "type": "string" }
                                                }
                                            }
                                        }
                                    }
                                }
                            },
                            "responses": {
                                "200": { "description": "Success" }
                            }
                        }
                    },
                    "/api/project/anomalies": {
                        "get": {
                            "summary": "Get Ticket Anomalies",
                            "description": "Fetch list of detected ticket anomalies.",
                            "responses": {
                                "200": {
                                    "description": "List of anomalies",
                                    "content": {
                                        "application/json": {
                                            "schema": {
                                                "type": "array",
                                                "items": {
                                                    "type": "object",
                                                    "properties": {
                                                        "id": { "type": "integer" },
                                                        "ticket_number": { "type": "string" },
                                                        "ticket_title": { "type": "string" },
                                                        "tp_number": { "type": "string" },
                                                        "tp_title": { "type": "string" },
                                                        "assignee": { "type": "string" },
                                                        "parent_status": { "type": "string" },
                                                        "anomaly_reason": { "type": "string" },
                                                        "detected_at": { "type": "integer" }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            };

            window.ui = SwaggerUIBundle({
                spec: spec,
                dom_id: '#swagger-ui',
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                layout: "StandaloneLayout"
            });
        };
    </script>
</body>

</html>